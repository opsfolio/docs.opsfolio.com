---
title: "Fleetfolio EAA - Pentest Lite (Authorized)"
description: "Lightweight, authorized, container-run external asset assessment with structured artifacts"
---

This spry runbook performs an **authorized, lightweight external asset assessment** inside a Kali linux container (default base: `kalilinux/kali-last-release`). It orchestrates a chain of reconnaissance and validation tools to discover domains, resolve DNS, probe for web services, scan ports, fingerprint technologies, check TLS certificates, and run targeted vulnerability checks. All artifacts are stored under `/opt/eaa/sessions/$timestamps/<tool>/…` in structured formats such as JSON, JSONL, XML, or plain text.

The runbook is meant to be **safe, idempotent, and scope-aware**, honoring exclusions and customer authorization.

All packages come from `Debian`. When they don't come from Debian, we use `Homebrew`. If not available in Homebrew, we use `eget`. If none of these work, we install it directly using runtime installation instructions.

## Roadmap

- [ ] Introduce Masscan for High-speed Internet-scale port scanning with banner grabbing
- [ ] Introduce AutoRecon for Comprehensive automated reconnaissance with 35+ parameters
- [ ] Introduce Fierce for DNS reconnaissance and zone transfer testing

## Manual Installation of Kali Linux in VirtualBox

This guide will help you manually install **Kali Linux** in **VirtualBox** on your host machine.

### Prerequisites

- **VirtualBox**: Download VirtualBox
- If you are using Windows as the host machine, you may encounter an error while downloading or installing VirtualBox due to missing Visual C++ dependencies. Download the package from Visual C++ Redistributable Runtimes All-in-One and run `install_all.bat`
- **Kali Linux Virtual Machine**: Download Kali Linux VM (VirtualBox, 3.3 GB, `.7z` file)
- **WinRAR** or **7-Zip** for extraction: Download WinRAR (recommended)

### Installation Steps

1. **Download Kali Linux** - Select **Virtual Machine** and **VirtualBox (3.3 GB)** in `.7z` format

2. **Download and install VirtualBox** - Open VirtualBox Downloads and install on your host machine

3. **Extract Kali Linux VM** - Use **WinRAR** or **7-Zip** to extract to Downloads folder. Double-click the `.vbox` file to automatically import into VirtualBox

4. **Configure the Virtual Machine** - Set **Base Memory** to `4096 MB` and **Processor Cores** to `2–3` (recommended)

5. **Login** - Default credentials: Username: `kali`, Password: `kali`

6. **Switch to Root User** - Run `sudo su` in terminal for root privileges

7. **Update the System** - Run:
   ```bash
   sudo apt update && sudo apt upgrade -y && sudo apt full-upgrade -y
   ```

**Note:** Always use updated VirtualBox and Kali Linux versions to avoid compatibility issues.

### Fixing Errors

If you encounter errors, run:

```bash
sudo sed -i 's|http://http.kali.org|https://http.kali.org|' /etc/apt/sources.list
sudo apt-get clean && sudo apt-get update --fix-missing
sudo apt update && sudo apt upgrade -y && sudo apt full-upgrade -y
```

### Prerequisite Dependencies

**Homebrew**

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)" && echo >> /home/kali/.zshrc && echo 'eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"' >> /home/kali/.zshrc && eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)" && sudo apt-get install -y build-essential && brew install gcc
```

Note: Run this in non-root terminal, enter password when prompted

**Go**

```bash
sudo apt install golang-go -y
```

### Install Deno

Deno is a modern, secure runtime for JavaScript and TypeScript. Install with:

```bash
brew install deno
```

### Install Surveilr

Get the latest Resource Surveillance & Integration Engine:

```bash
wget https://github.com/surveilr/packages/releases/download/3.16.0/surveilr_3.16.0_x86_64-unknown-linux-gnu.tar.gz && \
tar xvf surveilr_3.16.0_x86_64-unknown-linux-gnu.tar.gz && \
mv surveilr /usr/local/bin
```

Find latest releases on the releases page.

To make Homebrew tools accessible from root:

```bash
sudo su && echo 'eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"' >> /root/.zshrc && eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
```

### Prerequisite API Keys/Tokens

**WPScan**

- Visit WPScan Registration Page
- Fill registration form and verify email
- Sign in and generate API key
- Add to `.env` file

**VirusTotal**

- Visit VirusTotal Join Us page
- Create account and verify email
- Sign in to dashboard
- Copy API key and add to `.env`

### Tools Installation

Pre-installed in Kali Linux: Whatweb, Nmap, Openssl, wafw00f, sqlmap, WPScan, Amass, Nikto, DNSEnum, TheHarvester, SSLyze, smtp-user-enum

Install additional tools:

```bash
sudo apt install -y subfinder dnsx httpx-toolkit naabu nuclei xq jq dirsearch testssl.sh paramspider commix && \
git clone https://github.com/s0md3v/Corsy.git && cd Corsy && pip3 install -r requirements.txt --break-system-packages
go install github.com/projectdiscovery/katana/cmd/katana@latest && sudo cp ~/go/bin/katana /bin/ && \
go install github.com/projectdiscovery/tlsx/cmd/tlsx@latest && sudo cp ~/go/bin/tlsx /bin/ && \
go install -v github.com/PentestPad/subzy@latest && sudo cp ~/go/bin/subzy /bin/ && \
go install -v github.com/projectdiscovery/pdtm/cmd/pdtm@latest && sudo cp ~/go/bin/pdtm /bin/ && \
go install github.com/intigriti/misconfig-mapper/cmd/misconfig-mapper@latest && sudo cp ~/go/bin/misconfig-mapper /bin/ && \
sudo apt install -y libpcap-dev && pdtm -install-all && sudo cp /home/kali/.pdtm/go/bin/* /bin && \
git clone https://github.com/r0oth3x49/ghauri.git && cd ghauri && sudo python3 setup.py install && \
pip install fierce --break-system-packages && \
wget https://github.com/cerberauth/vulnapi/releases/download/v0.8.9/vulnapi_0.8.9_linux_amd64.deb && \
dpkg -i vulnapi_0.8.9_linux_amd64.deb && \
git clone https://github.com/nemesida-waf/waf_bypass.git waf_bypass && cd waf_bypass && pip3 install -r requirements.txt --break-system-packages && \
brew install rustscan dalfox trivy
```

### Clone Repository

```bash
git clone https://github.com/surveilr/www.surveilr.com.git && \
cd www.surveilr.com/lib/service/fleetfolio/eaa
```

Add domains, URLs, IPs in `.env` file:

```bash
sudo tee -a .env > /dev/null << 'EOF'
OPSFOLIO_EAA_HOME=/opt/eaa/sessions
OPSFOLIO_EAA_TENANT_ID=NET1234
OPSFOLIO_EAA_TENANT_NAME=Netspective
OPSFOLIO_EAA_PURPOSE=Threat
OPSFOLIO_EAA_DESCRIPTION=Demo_Threat
OPSFOLIO_EAA_CONTEXT_JSON='{ "Sample": "Value" }'
OPSFOLIO_EAA_EXIT_EMAIL_ADDRESSES=example@nespective.com
OPSFOLIO_EAA_DOMAINS=netspective.com
OPSFOLIO_EAA_SUBDOMAINS=
OPSFOLIO_EAA_IP_RANGES=
OPSFOLIO_EAA_EXCLUDES=
OPSFOLIO_EAA_KEY_URLS=https://netspective.com/
OPSFOLIO_EAA_KEY_APIS=
OPSFOLIO_EAA_KEY_GIT_URLS=
OPSFOLIO_EAA_CORSY_PATH=/opt/eaa/Corsy
OPSFOLIO_EAA_WP_TOKEN=TOKEN
OPSFOLIO_EAA_VIRUSTOTAL_API_KEY=KEY
OPSFOLIO_EAA_RATE_LIMIT=200
OPSFOLIO_EAA_CONCURRENCY=50
OPSFOLIO_EAA_NAABU_PORTS=top-100
OPSFOLIO_EAA_NUCLEI_TEMPLATES=cves,default
EOF
```

### Install spry

Ensure deno and brew are installed first:

```bash
brew install programmablemd/packages/spry
```

### Run Spry Commands

Run entire workflow:

```bash
sudo spry rb run fleetfolio-eaa-pentest-lite.spry.md --verbose rich
```

Run single task:

```bash
sudo spry rb task <task_id> fleetfolio-eaa-pentest-lite.spry.md --verbose rich
```

See spry documentation for task_id details.

### Automated Docker Method

Install Docker:

```bash
sudo apt update && sudo apt install docker.io -y && sudo systemctl enable docker --now
```

Fix errors if needed:

```bash
sudo sed -i 's|http://http.kali.org|https://http.kali.org|' /etc/apt/sources.list && sudo apt-get clean && sudo apt-get update --fix-missing
```

Clone repository and configure `.env` as shown above, then run:

```bash
sudo docker build -t fleetfolio-eaa:latest . && \
sudo docker run --rm -it -v $(pwd)/results:/opt/eaa/sessions/ fleetfolio-eaa:latest
```

Results will be in the `results` directory on your local machine.

## Environment Variables

- `OPSFOLIO_EAA_HOME` – (default: `opt/eaa/sessions`)
- `OPSFOLIO_EAA_TENANT_ID` – tenant IDs, comma/space-separated
- `OPSFOLIO_EAA_TENANT_NAME` – tenant names, comma/space-separated
- `OPSFOLIO_EAA_PURPOSE` – required string
- `OPSFOLIO_EAA_DESCRIPTION` – optional string
- `OPSFOLIO_EAA_CONTEXT_JSON` – optional JSON object
- `OPSFOLIO_EAA_EXIT_EMAIL_ADDRESS` – email, comma/space-separated
- `OPSFOLIO_EAA_DOMAINS` – domains, comma/space-separated
- `OPSFOLIO_EAA_IP_RANGES` – IPs/CIDRs, comma/space-separated
- `OPSFOLIO_EAA_KEY_URLS` – URLs, comma/space-separated
- `OPSFOLIO_EAA_KEY_APIS` – APIs, comma/space-separated
- `OPSFOLIO_EAA_KEY_GIT_URLS` – Git URLs, comma/space-separated
- `OPSFOLIO_EAA_EXCLUDES` – exclusions, comma/space-separated
- `OPSFOLIO_EAA_CORSY_PATH` – (default: `/opt/eaa/Corsy`)
- `OPSFOLIO_EAA_WP_TOKEN` – required string
- `OPSFOLIO_EAA_VIRUSTOTAL_API_KEY` – required string
- `OPSFOLIO_EAA_RATE_LIMIT` – (default: 200)
- `OPSFOLIO_EAA_CONCURRENCY` – (default: 50)
- `OPSFOLIO_EAA_NAABU_PORTS` – (default: top-100)
- `OPSFOLIO_EAA_NUCLEI_TEMPLATES` – (default: cves,default)

## Analyst's Guide to Interpreting Artifacts

This appendix provides guidance for reviewing outputs from each tool.

### Subfinder (`subfinder.jsonl`)

Each JSON line has `host` and `source` fields. Look for:

- Unexpected or unmanaged subdomains
- Entries that don't resolve later in dnsx (may indicate legacy records)

### dnsx (`dnsx.jsonl`)

Contains DNS resolution results (A/AAAA, CNAME). Check:

- IPs map to owned infrastructure
- Third-party networks that might be unmanaged

### httpx-toolkit (`httpx-toolkit.jsonl`)

Live web service metadata: status codes, titles, headers. Review:

- Sensitive endpoints (admin panels, login portals)
- Unusual server headers or technologies outside policy

### WhatWeb (`whatweb/*.json`)

Per-target plugin/technology detection. Identify:

- Outdated CMS or frameworks
- Versions against known vulnerabilities

### Naabu (`naabu.jsonl`)

Open IPs and ports. Spot:

- Unexpected ports (databases, RDP, SSH exposed)
- High-risk services (SMB, Telnet, legacy protocols)

### Nmap (`nmap.xml`)

Service banners and versions. Evaluate:

- Accuracy of Naabu findings
- Service versions for end-of-life software

### OpenSSL (`tls/*.txt`)

TLS handshakes and certificates. Check:

- Expiry dates, SAN entries, issuers
- Self-signed or weakly signed certificates

### Nuclei (`nuclei.txt`)

Template-matched findings. Sort by:

- Severity for prioritization
- Validate important findings manually

### Katana (`katana.jsonl`)

Discovered web endpoints. Look for:

- API endpoints, hidden admin paths
- Cross-reference with vulnerability coverage

This document contains extensive details for all 30+ scanning tools and their artifact interpretation. For the complete runbook and additional tool documentation, refer to the official Fleetfolio repository.