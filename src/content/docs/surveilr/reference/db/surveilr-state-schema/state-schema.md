---
title: Resource Surveillance State Schema
description: Documentation for the resource surveillance CLI tool.
---

## Tables

| Name                                                                         | Columns | Comment                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Type  |
| ---------------------------------------------------------------------------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----- |
| [device](device)                                                             | 14      | Identity, network segmentation, and sysinfo for devices on which uniform_resource are found                                                                                                                                                                                                                                                                                                                                                                                                                                                           | table |
| [behavior](behavior)                                                         | 13      | Behaviors are configuration "presets" that can be used to drive<br>application operations at runtime. For example, ingest behaviors<br>include configs that indicate which files to ignore, which to<br>scan, when to load content, etc. This is more convenient than<br>creating<br><br>behavior has a foreign key reference to the device table since<br>behaviors might be device-specific.                                                                                                                                                        | table |
| [ur_ingest_resource_path_match_rule](ur_ingest_resource_path_match_rule)     | 15      | A regular expression can determine the flags to apply to an ingestion path<br>and if the regular expr contains a nature capture group that pattern match<br>will assign the nature too.                                                                                                                                                                                                                                                                                                                                                               | table |
| [ur_ingest_resource_path_rewrite_rule](ur_ingest_resource_path_rewrite_rule) | 14      | A regular expression can determine whether certain paths should be<br>rewritten before ur_ingest_resource_path_match_rule matches occur.                                                                                                                                                                                                                                                                                                                                                                                                              | table |
| [ur_ingest_session](ur_ingest_session)                                       | 14      | Immutable ingestion sessions represents any "discovery" or "walk" operation. This could be a device file system scan or any other resource discovery session. Each time a discovery operation starts, a record is created. ur_ingest_session has a foreign key reference to the device table so that the same device can be used for multiple ingest sessions but also the ingest sessions can be merged across workstations / servers for easier detection of changes and similaries between file systems on different devices.                      | table |
| [ur_ingest_session_fs_path](ur_ingest_session_fs_path)                       | 11      | Immutable ingest session file system path represents a discovery or "walk" path. If the session included a file system scan, then root_path is the root file system path that was scanned. If the session was discovering resources in another target then root_path would be representative of the target path (could be a URI).                                                                                                                                                                                                                     | table |
| [uniform_resource](uniform_resource)                                         | 20      | Immutable resource and content information. On multiple executions,<br>uniform_resource are inserted only if the the content (see unique<br>index for details). For historical logging, uniform_resource has foreign<br>key references to both ur_ingest_session and ur_ingest_session_fs_path<br>tables to indicate which particular session and ingestion path the<br>resourced was inserted during.                                                                                                                                                | table |
| [uniform_resource_transform](uniform_resource_transform)                     | 15      | uniform_resource transformed content                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | table |
| [ur_ingest_session_fs_path_entry](ur_ingest_session_fs_path_entry)           | 21      | Contains entries related to file system content ingestion paths. On multiple executions, unlike uniform_resource, ur_ingest_session_fs_path_entry rows are always inserted and references the uniform_resource primary key of its related content. This method allows for a more efficient query of file version differences across sessions. With SQL queries, you can detect which sessions have a file added or modified, which sessions have a file deleted, and what the differences are in file contents if they were modified across sessions. | table |
| [ur_ingest_session_task](ur_ingest_session_task)                             | 15      | Contains entries related to task content ingestion paths. On multiple executions, unlike uniform_resource, ur_ingest_session_task rows are always inserted and references the uniform_resource primary key of its related content. This method allows for a more efficient query of file version differences across sessions. With SQL queries, you can detect which sessions have a file added or modified, which sessions have a file deleted, and what the differences are in file contents if they were modified across sessions.                 | table |

## Relations

![er](../../../../../../assets/schema.svg)
